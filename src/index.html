<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CC Version Guard</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://unpkg.com/@phosphor-icons/web@2.1.1"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div id="app">

    <!-- Progress Bar -->
    <div class="progress-bar">
      <div class="progress-step" data-step="1">
        <div class="step-dot"></div>
        <span>Start</span>
      </div>
      <div class="progress-line"></div>
      <div class="progress-step" data-step="2">
        <div class="step-dot"></div>
        <span>Select</span>
      </div>
      <div class="progress-line"></div>
      <div class="progress-step" data-step="3">
        <div class="step-dot"></div>
        <span>Options</span>
      </div>
      <div class="progress-line"></div>
      <div class="progress-step" data-step="4">
        <div class="step-dot"></div>
        <span>Done</span>
      </div>
    </div>

    <!-- Screen: Welcome -->
    <div id="screen-welcome" class="screen active">
      <div class="screen-content">
        <div class="icon-wrap accent">
          <i class="ph-fill ph-shield-check"></i>
        </div>
        <h1>CC Version Guard</h1>
        <p class="subtitle">Lock your CapCut version and prevent auto-updates.</p>

        <div class="info-card">
          <div class="info-row">
            <i class="ph ph-check-circle"></i>
            <span>Protect against forced updates</span>
          </div>
          <div class="info-row">
            <i class="ph ph-check-circle"></i>
            <span>Clean cache to free disk space</span>
          </div>
          <div class="info-row">
            <i class="ph ph-check-circle"></i>
            <span>Download legacy versions</span>
          </div>
        </div>

        <button class="btn-primary" onclick="startCheck()">
          <i class="ph-bold ph-play"></i> Start Protection
        </button>

        <a class="link-secondary" onclick="showScreen('download-manager')">
          <i class="ph ph-download-simple"></i> Download a Legacy Version
        </a>
      </div>
    </div>

    <!-- Screen: Download Manager -->
    <div id="screen-download-manager" class="screen">
      <div class="screen-content wide">
        <h2>Download Legacy Version</h2>
        <p class="subtitle">Choose from official ByteDance archives.</p>

        <div id="version-grid" class="version-grid">
          <!-- Populated by JS -->
        </div>

        <button class="btn-secondary" onclick="showScreen('welcome')">
          <i class="ph ph-arrow-left"></i> Back
        </button>
      </div>
    </div>

    <!-- Screen: PreCheck -->
    <div id="screen-precheck" class="screen">
      <div class="screen-content">
        <div class="icon-wrap">
          <i class="ph-fill ph-magnifying-glass spinning"></i>
        </div>
        <h2>Scanning System</h2>
        <p class="subtitle" id="precheck-status">Looking for CapCut installations...</p>
      </div>
    </div>

    <!-- Screen: CapCut Running -->
    <div id="screen-running-warning" class="screen">
      <div class="screen-content">
        <div class="icon-wrap warning">
          <i class="ph-fill ph-warning"></i>
        </div>
        <h2>CapCut is Running</h2>
        <p class="subtitle">Please close CapCut before continuing.</p>

        <button class="btn-primary" onclick="startCheck()">
          <i class="ph-bold ph-arrow-clockwise"></i> Check Again
        </button>
      </div>
    </div>

    <!-- Screen: Not Found -->
    <div id="screen-not-found" class="screen">
      <div class="screen-content">
        <div class="icon-wrap">
          <i class="ph-fill ph-folder-notch-open"></i>
        </div>
        <h2>CapCut Not Found</h2>
        <p class="subtitle">No installation detected on this system.</p>

        <button class="btn-primary" onclick="showScreen('download-manager')">
          <i class="ph-bold ph-download-simple"></i> Download a Version
        </button>

        <a class="link-secondary" onclick="startCheck()">
          <i class="ph ph-arrow-clockwise"></i> Scan Again
        </a>
      </div>
    </div>

    <!-- Screen: Version Select -->
    <div id="screen-version-select" class="screen">
      <div class="screen-content">
        <h2>Select Version to Keep</h2>
        <p class="subtitle">All other versions will be removed.</p>

        <div id="installed-versions" class="version-list">
          <!-- Populated by JS -->
        </div>

        <button id="btn-continue-select" class="btn-primary" disabled onclick="goToCacheScreen()">
          <i class="ph-bold ph-arrow-right"></i> Continue
        </button>

        <a class="link-secondary" onclick="showScreen('welcome')">
          <i class="ph ph-arrow-left"></i> Back
        </a>
      </div>
    </div>

    <!-- Screen: Cache Clean Options -->
    <div id="screen-cache-clean" class="screen">
      <div class="screen-content">
        <h2>Cache Cleanup</h2>
        <p class="subtitle">Free up disk space by removing temporary files.</p>

        <div class="cache-card">
          <div class="cache-info">
            <span class="cache-label">Recoverable Space</span>
            <span class="cache-value" id="cache-size">0 MB</span>
          </div>
          <label class="toggle-row">
            <input type="checkbox" id="cache-toggle" checked />
            <span class="toggle-switch"></span>
            <span>Clean cache during protection</span>
          </label>
        </div>

        <button class="btn-primary" onclick="startProtection()">
          <i class="ph-bold ph-shield-check"></i> Apply Protection
        </button>

        <a class="link-secondary" onclick="showScreen('version-select')">
          <i class="ph ph-arrow-left"></i> Back
        </a>
      </div>
    </div>

    <!-- Screen: Running -->
    <div id="screen-running" class="screen">
      <div class="screen-content">
        <div class="icon-wrap">
          <i class="ph-fill ph-gear spinning"></i>
        </div>
        <h2>Applying Protection</h2>
        <p class="subtitle" id="running-status">Preparing...</p>

        <div class="progress-container">
          <div class="progress-fill" id="progress-fill"></div>
        </div>

        <div id="action-log" class="action-log">
          <!-- Populated by JS -->
        </div>
      </div>
    </div>

    <!-- Screen: Complete -->
    <div id="screen-complete" class="screen">
      <div class="screen-content">
        <div class="icon-wrap success">
          <i class="ph-fill ph-shield-check"></i>
        </div>
        <h2>Protection Complete!</h2>
        <p class="subtitle" id="complete-text">Your CapCut installation is now protected.</p>

        <div class="success-summary">
          <div class="summary-row"><i class="ph-fill ph-check-circle"></i> Versions cleaned</div>
          <div class="summary-row"><i class="ph-fill ph-check-circle"></i> Configuration locked</div>
          <div class="summary-row"><i class="ph-fill ph-check-circle"></i> Update blocker active</div>
          <div class="summary-row" id="cache-cleaned-row"><i class="ph-fill ph-check-circle"></i> Cache cleaned</div>
        </div>

        <div class="actions">
          <button class="btn-secondary" onclick="window.location.reload()">
            <i class="ph-bold ph-arrow-counter-clockwise"></i> Start Over
          </button>
          <button class="btn-primary" onclick="window.close()">
            <i class="ph-bold ph-x"></i> Close
          </button>
        </div>

        <a class="link-secondary" onclick="openGitHub()">
          <i class="ph ph-github-logo"></i> View on GitHub
        </a>
      </div>
    </div>

    <!-- Screen: Error -->
    <div id="screen-error" class="screen">
      <div class="screen-content">
        <div class="icon-wrap error">
          <i class="ph-fill ph-warning-octagon"></i>
        </div>
        <h2>Something Went Wrong</h2>
        <p class="subtitle" id="error-text">An error occurred.</p>

        <button class="btn-primary" onclick="showScreen('welcome')">
          <i class="ph-bold ph-arrow-clockwise"></i> Try Again
        </button>
      </div>
    </div>

  </div>

  <script src="main.js"></script>
</body>
</html>
